{% extends 'main/base.html' %}

{% block content %}
    <h1>Все фотосессии</h1>
    
    {# Отображение категорий #}
    <div class="categories">
        {% for category_name, category in categories.items() %}
            <a href="{{ url_for('photosession.category_photoshoots', category_name=category_name) }}">
                {{ category.value }}
            </a>
        {% endfor %}
    </div>

    {# Отображение фотосессий #}
    {% for photoshoot in photoshoots.items %}
        <div class="photoshoot">
            <h2>{{ photoshoot.title }}</h2>
            <p>Категория: {{ photoshoot.category.value }}</p>

            {# Отображение первого фото #}
            {% if photoshoot.photos|length > 0 %}
                <div class="photo-gallery">
                    <img src="{{ url_for('static', filename='upload/' ~ photoshoot.category.name ~ '/' ~ photoshoot.photos[0].filename) }}" alt="{{ photoshoot.title }}" class="photoshoot-image" loading="lazy">
                </div>
            {% else %}
                <p>Нет доступных фотографий</p>
            {% endif %}

            <a href="{{ url_for('photosession.view_photoshoot', category_name=photoshoot.category.name, id=photoshoot.id) }}">
                Подробнее
            </a>
        </div>
    {% endfor %}

    {# Пагинация #}
    <div class="pagination">
        {% if photoshoots.has_prev %}
            <a href="{{ url_for('photosession.list_photoshoots', page=photoshoots.prev_num) }}">Предыдущая</a>
        {% endif %}

        {% for page in photoshoots.iter_pages() %}
            {% if page %}
                {% if page != photoshoots.page %}
                    <a href="{{ url_for('photosession.list_photoshoots', page=page) }}">{{ page }}</a>
                {% else %}
                    <strong>{{ page }}</strong>
                {% endif %}
            {% else %}
                <span>...</span>
            {% endif %}
        {% endfor %}

        {% if photoshoots.has_next %}
            <a href="{{ url_for('photosession.list_photoshoots', page=photoshoots.next_num) }}">Следующая</a>
        {% endif %}
    </div>
<style>
    .photo-gallery {
    width: 150px; /* Фиксированная ширина контейнера */
    height: 100px; /* Фиксированная высота контейнера */
    overflow: hidden; /* Скрытие переполняющего содержимого */
    margin-bottom: 10px; /* Отступ снизу для разделения изображений */
    border: 1px solid #ccc; /* Параметры границы */
    border-radius: 4px; /* Закругление углов */
}

.photoshoot-image {
    width: 100%; /* Ширина изображения 100% от родительского контейнера */
    height: 100%; /* Высота изображения 100% от родительского контейнера */
    object-fit: cover; /* Сохранение пропорций изображения с обрезкой */
}

{% endblock %}
